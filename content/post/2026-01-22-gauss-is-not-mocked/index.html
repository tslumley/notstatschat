---
title: Gauss is Not Mocked
author: Thomas Lumley
date: '2026-01-22'
slug: gauss-is-not-mocked
categories: []
tags: []
---



<p><em>Attention Conservation Notice: I stole the title from Cosma Shalizi, who is a better writer than me. He meant the central limit theorem; I mean the Gauss-Markov theorem. Also, this is about multiparameter tests, which are intrinsically not very interesting</em></p>
<p>In survey statistics, there are two classes of tests that are widely used for contingency tables and rather less widely used for regression models.</p>
<p>If you have a vector <span class="math inline">\(\hat\beta\sim N(\beta,\Xi)\)</span> of parameter estimates and you want to test <span class="math inline">\(\beta=0\)</span> (yes, or <span class="math inline">\(\beta=\beta_0\)</span>) there are problems due to the survey design. The variance of <span class="math inline">\(\hat\beta\)</span> is not the inverse Fisher information; it’s a sandwich <span class="math inline">\(V=A^{-1}BA^{-1}\)</span> where <span class="math inline">\(A\)</span> is a weighted estimate of the population Fisher information on the outside and <span class="math inline">\(B\)</span> is a design-based variance estimate for the score function.</p>
<p>Under standard iid sampling, if you want to test <span class="math inline">\(\beta=0\)</span> for more than one parameter you would obviously weight the components by their estimated precision matrix. Under complex sampling you have options:</p>
<ul>
<li><span class="math inline">\(V^{-1}\)</span>, the estimated precision matrix for this design and sample<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></li>
<li><span class="math inline">\(A\)</span>, the estimated population precision matrix</li>
</ul>
<p>The motivation for the first one is obvious: it’s the precision matrix. Also, the test statistic has a nice simple <span class="math inline">\(\chi^2\)</span> distribution.
The motivation for the second one is partly that the weighting of different directions doesn’t depend on the design, partly that it helps you interpret tests done by people who don’t understand complex sampling, and partly that it has better control of level</p>
<p>The second family of tests are called the Rao-Scott tests, after JNK Rao and Alastair Scott. Rao and Scott derived them in the 1980s, initially to answer the question “if some misguided person does a Pearson <span class="math inline">\(X^2\)</span> test on an estimated population table then what, if anything, do the results mean?”. The tests were then used more widely in survey statistics and were shown to have better Type I error than the competition.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> The first family don’t seem to have a name; I’ll call them <em>intrinsically-weighted tests</em>.</p>
<p>Anyway. A few years ago, Keiran Shao did a Masters project with me, looking at the performance of the likelihood, Wald, and score versions of the Rao-Scott test and the Wald and score versions of the intrinsically weighted tests for regression models.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> As I expected, he found that the Rao-Scott-type tests had better control of level. As I completely didn’t expect, he found they had lower power.</p>
<p>Usually you think of statements like “the Rao-Scott tests are less powerful than the intrinsically-weighted tests” as <em>Not Even Wrong</em>; someone just didn’t do a broad enough simulation study. That is, usually one test is more powerful than another against some alternatives and less powerful against other alternatives, but you can’t make any general statements. We know, for example, that there aren’t uniformly most powerful tests in any interesting setting.</p>
<p>This time is different. It’s still true that neither set of tests is <em>uniformly</em> more powerful, but I think it’s not misleading to say the Rao-Scott tests are typically less powerful. Which is a pity; I like them.</p>
<p>As evidence, here’s a fairly comprehensive picture of the two-parameter case. We want to compare the test based on <span class="math inline">\(\hat\beta^T V^{-1}\hat\beta\)</span> with the test based on some other <span class="math inline">\(\hat\beta^T W\hat\beta\)</span>.</p>
<p>It is no loss of generality to assume the sample covariance matrix <span class="math inline">\(V\)</span> is a multiple of the identity, since we can linearly reparametrise <span class="math inline">\(\beta\)</span> to obtain this. It is then no loss of generality to assume the weight matrix <span class="math inline">\(W\)</span> is diagonal, by applying a rotation if necessary. Since the weight matrix is used only as weigts, its overall scale doesn’t matter; only the ratio of the two diagonal elements affects inference. We have thus reduced the choice of weight matrices to a single number, the ratio <span class="math inline">\(\phi\)</span> of the two eigenvalues of the population variance matrix.</p>
<p>We can parametrise the alternative hypothesis <span class="math inline">\(\beta=\beta_A\)</span> in polar coordinates. We choose the radius so that the power of the intrinsically-weighted test is a specified value and estimate the power of the Rao–Scott-type test by simulation. Suppose the chosen power is 75%. We plot a circle of radius 0.75 representing the power of the intrinsically-weighted test and a curve <span class="math inline">\((r,\theta)\)</span> where <span class="math inline">\(r\)</span> is the power of the Rao–Scott-type test in direction <span class="math inline">\(\theta\)</span> for the same set of alternatives. When the curve is outside the circle, the Rao-Scott-type test is more powerful in that direction than the intrinsically-weighted test.</p>
<p>The graph shows curves for 85% power, 5% level, and <span class="math inline">\(\phi\)</span> ranging from 1.1 up to 10.</p>
<p><img src="images/rs-power-2d.png" style="width:90.0%" /></p>
<p>When <span class="math inline">\(\phi\approx 1\)</span> the black curve is close to the purple circle; when <span class="math inline">\(\phi=10\)</span> it’s a long way from the circle. For alternatives in the same direction as the larger weight from <span class="math inline">\(W\)</span> (horizontally) the power of the Rao-Scott test is increased a little. For alternatives in the orthogonal direction (vertically) the power is reduced a lot. Overall, the Rao-Scott test has a small advantage over a small range of directions and a larger disadvantage over a larger range of directions.</p>
<p>So what’s going on? There are at least two contributions to this. The first is related to the Gauss-Markov theorem: among alternatives with the same average non-centrality parameters over all directions, the true precision matrix gives the smallest null variance and so should have greater power. The second is that the null distribution of the Rao-Scott tests has heavier tails than the <span class="math inline">\(\chi^2_2\)</span> distribution of the intrinsically-weighted tests, so the right tail probabilities (<span class="math inline">\(p\)</span>-values) will be larger.</p>
<p>The second argument suggests, which turns out to be true, that the situation will be worse at very small Type I error levels. It should be possible to do this sort of comprehensive analysis for three-parameter tests, but beyond that I think we’re stuck with simulations of specific cases.</p>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>as you would naturally do and as the Gauss-Markov theorem suggests<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><span class="math inline">\(B\)</span> can be very poorly estimated in surveys with a few large clusters. The Rao-Scott tests are sensitive to error in the largest eigenvalues of <span class="math inline">\(\hat B\)</span> and the other tests are sensitive to error in the reciprocals of the smallest eigenvalues of <span class="math inline">\(\hat B\)</span>, which is much worse.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>At that time I didn’t know how to define likelihood-ratio tests for the intrinsically-weighted series, but <a href="https://academic.oup.com/biomet/article-abstract/94/1/167/228777">this sort of thing</a> should work<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
